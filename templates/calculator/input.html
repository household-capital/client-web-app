{% load static %}
{% load humanize %}
{% load static %}
{% load crispy_forms_tags %}
{% load calc_extras %}

<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- The above 2 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="{% static 'img/favicon/favicon.png' %}"/>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.6.1/css/all.css"
          integrity="sha384-NJXGk7R+8gWGBdutmr+/d6XDokLwQhF1U3VA7FhvBDlOq7cNdI69z7NQdnXxcF7k" crossorigin="anonymous">
    <link href="/static/css/calculator.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134758045-1"
            type="a5a4f0e3d92d2c3efa0ba656-text/javascript"></script>
    <script type="a5a4f0e3d92d2c3efa0ba656-text/javascript">
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-134758045-1');



    </script>

    <!-- Google Analytics -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        function getClientIdFromUrl() {
            var url = window.location.href;
            var regex = new RegExp("[?&]clientId(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            console.log(results[2].replace(/\+/g, " "));
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        ga('create', 'UA-134758045-1', 'auto', {
            'clientId': getClientIdFromUrl()
        })
    </script>
    <!-- End Google Analytics -->


    <title>Household Capital Calculator</title>
</head>


<body>

<div class="container justify-content-md-center">
    <div class="row justify-content-md-center">
        <div class="col-md-11">
            <br><br>
            <div class="container cal_background">
                <div class="row">
                    <div class="col-md-12">
                        <form id="clientForm" method="post">
                            {% csrf_token %}
                            <div class="row">
                                <div class="col-md-6">
                                    <br>
                                    <p class="x-large">About you</p><br>


                                    <p>Your name:</p>
                                    <div id="div_id_name" class="form-group row pt-1">
                                        <div class="col-10">
                                            <input type="text" name="name" autofocus placeholder="Enter name (optional)"
                                                   class="textinput textInput form-control" id="id_name"
                                                   {% if form.name.value != None %}value="{{ form.name.value }}"{% endif %}>
                                        </div>
                                    </div>

                                    <div class="radio-hide">
                                        <p>Relationship Status:</p>
                                        <div class="row pt-1 pb-2">
                                            {% for choice in form.loanType.field.choices %}
                                                <div class="col-md-4 d-flex align-items-center">
                                                    <input {% if choice.0|intval == form.loanType.value|intval %}checked="checked" {% endif %}
                                                           id=loanType_{{ choice.1 }} type="radio"
                                                           name="loanType"
                                                           value={{ choice.0 }}>

                                                    <label class="radio-label {{ choice.1 }}"
                                                           for=loanType_{{ choice.1 }}></label>
                                                    <p class="small">{{ choice.1 }}</p>

                                                </div>

                                            {% endfor %}
                                        </div>
                                    </div>


                                    <p>Your age:</p>
                                    <div id="div_id_name" class="form-group row pt-1">
                                        <div class="col-md-5 pb-3">
                                            <input type="text" name="age_1" autofocus required placeholder="Your age"
                                                   class="textinput textInput form-control" id="id_age_1"
                                                   {% if form.age_1.value != None %}value="{{ form.age_1.value }}"{% endif %}>
                                        </div>
                                        <div class="col-md-5">
                                            <input type="text" name="age_2" autofocus placeholder="Spouse age"
                                                   class="textinput textInput form-control" id="id_age_2"
                                                   {% if form.age_2.value != None %}value="{{ form.age_2.value }}"{% endif %}>

                                        </div>

                                        <br><br>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <br>
                                    <p class="x-large">About your home</p><br>

                                    <p>Your postcode:</p>
                                    <div class="col-md-5">
                                        <div id="div_id_name" class="form-group row pt-1">
                                            <input type="text" name="postcode" autofocus required placeholder="Postcode"
                                                   class="textinput textInput form-control" id="id_postcode"
                                                   {% if form.postcode.value != None %}value="{{ form.postcode.value }}"{% endif %}>
                                        </div>
                                    </div>

                                    <div class="radio-hide">
                                        <p>Home type:</p>
                                        <div class="row pt-1 pb-2">
                                            {% for choice in form.dwellingType.field.choices %}
                                                <div class="col-md-5 d-flex align-items-center">
                                                    <input {% if choice.0|intval == form.dwellingType.value|intval %}checked="checked" {% endif %}
                                                           id={{ choice.1 }} type="radio"
                                                           name="dwellingType"
                                                           value={{ choice.0 }}>
                                                    <label class="radio-label {{ choice.1 }}"
                                                           for={{ choice.1 }}></label>
                                                    <p class="small">{{ choice.1 }}</p>

                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>

                                    <p>Home value:</p>
                                    <div class="col-md-5">
                                        <div id="div_id_valuation" class="form-group row pt-1">
                                            <input type="text" name="valuation" autofocus placeholder="Estimated value"
                                                   class="textinput textInput form-control" required id="id_valuation"
                                                   {% if form.valuation.value != None %}value="{{ form.valuation.value }}"{% endif %}>
                                        </div>

                                        <br>
                                    </div>

                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-2">
                                    <button type="submit" value="Submit" form="clientForm" class="btn btn-hhcGold">
                                        &nbsp;&nbsp;Calculate&nbsp;&nbsp;
                                    </button>
                                    <br> <br>
                                </div>
                            </div>

                            <input type='hidden' name="referrer" id="id_referrer"
                                   value="{{ request.META.HTTP_REFERER }}">

                        </form>

                        <div class="row justify-content-center">
                            <div class="col-md-8 text-center">
                                {% for message in messages %}
                                    <p{% if message.tags == 'error' %} class="alert alert-info"{% endif %}
                                            {% if message.tags == 'success' %} class="alert alert-success"{% endif %}>
                                        {{ message }}</p>
                                {% endfor %}

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script>

    function hideAge2(obj) {
        if (obj.is(':checked')) {
            $('#id_age_2').removeAttr('required');
            $('#id_age_2').hide();

        }
    }

    function showAge2(obj) {
        if (obj.is(':checked')) {
            $('#id_age_2').show();
            $('#id_age_2').attr("required", "")
        }
    }

    $(document).ready(function () {

        hideAge2($('#loanType_Single'));

        showAge2($('#loanType_Couple'));


        $('#id_name').focus();


        $('#loanType_Single').click(function () {
            hideAge2($(this));
        });

        $('#loanType_Couple').click(function () {
            showAge2($(this));
        });

    })

</script>

</body>


